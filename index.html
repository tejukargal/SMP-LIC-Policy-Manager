<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Staff LIC Records Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <div class="login-header">
                <h1>Staff LIC Records Management</h1>
                <p>Secure Access Portal</p>
            </div>

            <div class="login-content">
                <h2>Select Login Type</h2>

                <div class="login-options">
                    <button class="login-option-btn" id="userLoginBtn">
                        <div class="option-icon">üë§</div>
                        <div class="option-title">Login as User</div>
                        <div class="option-desc">View your LIC records</div>
                    </button>

                    <button class="login-option-btn" id="adminLoginBtn">
                        <div class="option-icon">üîê</div>
                        <div class="option-title">Login as Admin</div>
                        <div class="option-desc">Full access with edit privileges</div>
                    </button>
                </div>

                <!-- User Login Form (Hidden by default) -->
                <div id="userLoginForm" class="admin-login-form" style="display: none;">
                    <h3>User Login</h3>
                    <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 15px;">
                        Enter your Employee ID, Phone Number, or last 8 digits of Aadhar
                    </p>
                    <form id="userAuthForm">
                        <div class="form-group">
                            <label for="userCredential">Employee ID / Phone / Aadhar (last 8 digits)</label>
                            <input type="text" id="userCredential" required autocomplete="off" placeholder="e.g., 100156088 or 9740553884 or 05242999">
                        </div>
                        <div class="login-buttons">
                            <button type="submit" class="btn btn-primary">Login</button>
                            <button type="button" class="btn btn-cancel" id="backToOptionsFromUser">Back</button>
                        </div>
                    </form>
                </div>

                <!-- Admin Login Form (Hidden by default) -->
                <div id="adminLoginForm" class="admin-login-form" style="display: none;">
                    <h3>Admin Login</h3>
                    <form id="adminAuthForm">
                        <div class="form-group">
                            <label for="adminUsername">Username</label>
                            <input type="text" id="adminUsername" required autocomplete="username">
                        </div>
                        <div class="form-group">
                            <label for="adminPassword">Password</label>
                            <input type="password" id="adminPassword" required autocomplete="current-password">
                        </div>
                        <div class="login-buttons">
                            <button type="submit" class="btn btn-primary">Login</button>
                            <button type="button" class="btn btn-cancel" id="backToOptionsBtn">Back</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden by default) -->
    <div class="container" id="mainApp" style="display: none;">
        <header>
            <div class="header-content">
                <div>
                    <h1>Staff LIC Records Management System</h1>
                    <p class="subtitle">Manage LIC Policy Details for Staff Members</p>
                    <p class="user-info" id="userInfo"></p>
                </div>
                <div class="header-actions">
                    <button class="btn-logout" id="logoutBtn">Logout</button>
                    <button class="hamburger-menu" id="hamburgerBtn">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Hamburger Menu Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3>Menu</h3>
                <button class="close-sidebar" id="closeSidebar">&times;</button>
            </div>
            <div class="sidebar-content">
                <button class="menu-item" id="addStaffBtn">
                    <span class="menu-icon">üë§+</span>
                    <span>Add New Staff</span>
                </button>
                <button class="menu-item" id="migrateToDbBtn">
                    <span class="menu-icon">üîÑ</span>
                    <span>Migrate CSV to Database</span>
                </button>
                <button class="menu-item" id="backupBtn">
                    <span class="menu-icon">üíæ</span>
                    <span>Backup Data</span>
                </button>
                <button class="menu-item" id="restoreBtn">
                    <span class="menu-icon">üì•</span>
                    <span>Restore Data</span>
                </button>
                <button class="menu-item danger" id="deleteAllBtn">
                    <span class="menu-icon">üóëÔ∏è</span>
                    <span>Delete All Data</span>
                </button>
            </div>
        </div>
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <div class="stats-section" id="statsSection">
            <div class="stat-card stat-card-clickable" id="totalStaffCard">
                <span class="stat-number" id="totalStaff">0</span>
                <span class="stat-label" id="totalStaffLabel">Total Staff</span>
            </div>
            <div class="stat-card">
                <span class="stat-number" id="staffWithLIC">0</span>
                <span class="stat-label" id="staffWithLICLabel">Staff with LIC</span>
            </div>
            <div class="stat-card stat-card-clickable" id="totalPoliciesCard">
                <span class="stat-number" id="totalPolicies">0</span>
                <span class="stat-label" id="totalPoliciesLabel">Total Policies</span>
            </div>
        </div>

        <div class="search-section">
            <div class="search-container">
                <input
                    type="text"
                    id="searchInput"
                    placeholder="Search by Name, Emp ID, Aadhar (last 8 digits), Department, or Designation..."
                    class="search-input"
                >
                <button class="btn-search" id="searchBtn">Search</button>
                <button class="btn-clear" id="clearBtn">Clear</button>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">All Staff</button>
                <button class="filter-btn" data-filter="TEACHING">Teaching</button>
                <button class="filter-btn" data-filter="NON-TEACHING">Non-Teaching</button>
            </div>
        </div>

        <div class="staff-list" id="staffList">
            <!-- Staff items will be dynamically loaded here -->
        </div>
    </div>

    <!-- LIC Entry Modal -->
    <div id="licModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Enter LIC Details</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="staff-info-detailed" id="staffInfoDetailed">
                    <!-- Full staff details will be populated here -->
                </div>

                <form id="licForm">
                    <div class="policy-entries" id="policyEntries">
                        <div class="policy-entry">
                            <h3>Add New Policy Details</h3>
                            <div class="policy-form-row">
                                <div class="form-group">
                                    <label for="policyNo1">Policy Number</label>
                                    <input
                                        type="text"
                                        id="policyNo1"
                                        name="policyNo[]"
                                        class="uppercase-input"
                                        required
                                        autocomplete="off"
                                    >
                                </div>
                                <div class="form-group">
                                    <label for="premiumAmount1">Premium Amount (Rs.)</label>
                                    <input
                                        type="number"
                                        id="premiumAmount1"
                                        name="premiumAmount[]"
                                        step="0.01"
                                        min="0"
                                        required
                                        autocomplete="off"
                                    >
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="button-group">
                        <button type="button" class="btn btn-secondary" id="addMorePolicy">
                            + Add Another Policy
                        </button>
                    </div>
                </form>

                <div class="existing-policies" id="existingPolicies">
                    <!-- Existing policies table will be shown here -->
                </div>

                <div class="button-group-fixed">
                    <button type="submit" form="licForm" class="btn btn-primary" id="saveBtn">
                        Save LIC Details
                    </button>
                    <button type="button" class="btn btn-cancel" id="cancelBtn">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Hidden file input for restore -->
    <input type="file" id="restoreFileInput" accept=".json" style="display: none;">

    <!-- Staff Management Modal -->
    <div id="staffModal" class="modal">
        <div class="modal-content staff-modal-content">
            <div class="modal-header">
                <h2 id="staffModalTitle">Add New Staff</h2>
                <span class="close" id="closeStaffModal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="staffForm">
                    <input type="hidden" id="staffMode" value="add">
                    <input type="hidden" id="staffOriginalEmpId">

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffName">Name <span class="required">*</span></label>
                            <input type="text" id="staffName" required autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="staffEmpId">Employee ID <span class="required">*</span></label>
                            <input type="text" id="staffEmpId" required autocomplete="off">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffDesignation">Designation <span class="required">*</span></label>
                            <input type="text" id="staffDesignation" required autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="staffDept">Department <span class="required">*</span></label>
                            <select id="staffDept" required>
                                <option value="">Select Department</option>
                                <option value="OFFICE">OFFICE</option>
                                <option value="ME">ME</option>
                                <option value="CE">CE</option>
                                <option value="EC">EC</option>
                                <option value="CS">CS</option>
                                <option value="SCIENCE">SCIENCE</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffType">Type <span class="required">*</span></label>
                            <select id="staffType" required>
                                <option value="">Select Type</option>
                                <option value="TEACHING">TEACHING</option>
                                <option value="NON-TEACHING">NON-TEACHING</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="staffStatus">Status <span class="required">*</span></label>
                            <select id="staffStatus" required>
                                <option value="">Select Status</option>
                                <option value="IN SERVICE">IN SERVICE</option>
                                <option value="RTRD">RETIRED</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffDOB">Date of Birth (dd-mm-yy)</label>
                            <input type="text" id="staffDOB" placeholder="dd-mm-yy" maxlength="8" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="staffDOE">Date of Engagement (dd-mm-yy)</label>
                            <input type="text" id="staffDOE" placeholder="dd-mm-yy" maxlength="10" autocomplete="off">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffPhone">Phone Number</label>
                            <input type="text" id="staffPhone" maxlength="10" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="staffEmail">Email</label>
                            <input type="email" id="staffEmail" autocomplete="off">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="staffPAN">PAN</label>
                            <input type="text" id="staffPAN" maxlength="10" class="uppercase-input" autocomplete="off">
                        </div>
                        <div class="form-group">
                            <label for="staffAadhar">Aadhar (12 digits with spaces)</label>
                            <input type="text" id="staffAadhar" placeholder="XXXX XXXX XXXX" maxlength="14" autocomplete="off">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="staffBankAcct">Bank Account Number</label>
                            <input type="text" id="staffBankAcct" autocomplete="off">
                        </div>
                    </div>

                    <div class="button-group-fixed">
                        <button type="submit" class="btn btn-primary" id="saveStaffBtn">Save Staff</button>
                        <button type="button" class="btn btn-cancel" id="cancelStaffBtn">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Edit Policy Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content edit-modal-content">
            <div class="modal-header">
                <h2>Edit Policy Details</h2>
                <span class="close" id="closeEditModal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <input type="hidden" id="editPolicyId">
                    <input type="hidden" id="editStaffEmpId">

                    <div class="form-group">
                        <label for="editPolicyNo">Policy Number</label>
                        <input
                            type="text"
                            id="editPolicyNo"
                            class="uppercase-input"
                            required
                            autocomplete="off"
                        >
                    </div>

                    <div class="form-group">
                        <label for="editPremiumAmount">Premium Amount (Rs.)</label>
                        <input
                            type="number"
                            id="editPremiumAmount"
                            step="0.01"
                            min="0"
                            required
                            autocomplete="off"
                        >
                    </div>

                    <div class="form-group">
                        <label for="editMaturityDate">Maturity Date (dd/mm/yyyy)</label>
                        <input
                            type="text"
                            id="editMaturityDate"
                            placeholder="dd/mm/yyyy"
                            maxlength="10"
                            autocomplete="off"
                        >
                    </div>

                    <div class="button-group-fixed">
                        <button type="submit" class="btn btn-primary">Update</button>
                        <button type="button" class="btn btn-cancel" id="cancelEditBtn">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Total Policies Modal -->
    <div id="totalPoliciesModal" class="modal">
        <div class="modal-content total-policies-modal-content">
            <div class="modal-header">
                <h2>All Policies Overview</h2>
                <span class="close" id="closeTotalPoliciesModal">&times;</span>
            </div>
            <div class="modal-body">
                <div id="totalPoliciesTableContainer"></div>
            </div>
        </div>
    </div>

    <!-- Total Staff Modal -->
    <div id="totalStaffModal" class="modal">
        <div class="modal-content total-staff-modal-content">
            <div class="modal-header">
                <h2>All Staff Details</h2>
                <span class="close" id="closeTotalStaffModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="staff-filters">
                    <div class="filter-group">
                        <label for="filterType">Type:</label>
                        <select id="filterType" class="filter-select">
                            <option value="">All</option>
                            <option value="TEACHING">Teaching</option>
                            <option value="NON-TEACHING">Non-Teaching</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterDept">Department:</label>
                        <select id="filterDept" class="filter-select">
                            <option value="">All</option>
                            <option value="OFFICE">Office</option>
                            <option value="ME">ME</option>
                            <option value="CE">CE</option>
                            <option value="EC">EC</option>
                            <option value="CS">CS</option>
                            <option value="SCIENCE">Science</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="filterStatus">Status:</label>
                        <select id="filterStatus" class="filter-select">
                            <option value="">All</option>
                            <option value="IN SERVICE">In Service</option>
                            <option value="RTRD">Retired</option>
                        </select>
                    </div>
                    <button class="btn btn-secondary btn-reset-filters" id="resetFiltersBtn">Reset Filters</button>
                </div>
                <div id="totalStaffTableContainer"></div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
